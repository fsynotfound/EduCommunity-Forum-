# RGS Common

## 概述
RGS 通用模块提供了管理平台、游戏及相关功能的核心能力。通过精心设计的 API、高效的缓存机制和优化的数据访问策略，确保系统具备高性能、安全性和可扩展性。

---

## 1. 核心组件

### 1.1 平台管理
#### **平台服务 (Platform Service)**
- **功能描述**: 管理与平台相关的核心业务逻辑。
- **功能特点**:
  - 支持通过平台代码查询平台信息。
  - 使用缓存机制优化查询性能。
  - 提供实体映射和转换功能。

#### **平台实体 (Platform Entity)**
- **MongoDB 集合**: `platforms`
- **核心字段**: 
  - `code`（平台代码）、`name`（平台名称）、`description`（描述）、`status`（状态）、`apiKey`（API 密钥）。
- **性能优化**: 通过索引提升查询效率。

---

### 1.2 游戏管理
#### **游戏服务 (Game Service)**
- **功能描述**: 管理游戏基础信息。
- **功能特点**:
  - 提供游戏创建和查询功能。
  - 支持缓存以提升性能。

#### **游戏配置 (Game Configuration)**
- **功能描述**: 提供多维度的游戏配置管理。
- **功能特点**:
  - 支持按平台、运营商、品牌、国家和货币进行配置。
  - 使用 MongoDB 存储配置信息。
  - 提供 REST API 接口与外部系统交互。

---

### 1.3 免费游戏功能
#### **免费游戏服务 (Free Games Service)**
- **功能描述**: 管理和控制免费游戏功能。
- **功能特点**:
  - 支持奖励发放、确认和取消。
  - 包含验证逻辑，确保操作的正确性。

#### **免费游戏仓库 (Free Games Repository)**
- **存储**: MongoDB
- **功能特点**:
  - 支持多条件查询。
  - 管理免费游戏的状态。

---

### 1.4 游戏回合管理
#### **游戏回合服务 (Game Round Service)**
- **功能描述**: 跟踪游戏回合并管理交易记录。
- **功能特点**:
  - 管理游戏回合状态。
  - 处理交易记录。

#### **游戏回合实体 (Game Round Entity)**
- **MongoDB 集合**: `playerGameRounds`
- **功能特点**:
  - 记录详细的游戏回合信息。
  - 支持交易追踪。

---

## 2. 支持功能

### 2.1 HTTP 客户端配置
- **功能特点**:
  - 连接池管理。
  - 支持 SSL 配置。
  - 超时控制和监控。

### 2.2 对账系统
- **功能特点**:
  - 支持交易对账功能。
  - 提供错误处理和状态同步。

### 2.3 错误处理
- **功能特点**:
  - 统一的异常处理机制。
  - 标准化的错误响应。
  - 错误日志记录。

---

## 3. 技术实现

### 3.1 数据访问
- **数据库**: MongoDB
- **实现特点**:
  - 使用 Spring Data MongoDB 进行数据访问。
  - 通过索引优化查询性能。

### 3.2 缓存策略
- **框架**: Spring Cache
- **实现特点**:
  - 支持多级缓存。
  - 设计高效的缓存键。

### 3.3 API 设计
- **风格**: RESTful
- **实现特点**:
  - 提供 API 版本控制，确保向后兼容。
  - 参数验证，提升安全性和一致性。

### 3.4 安全性
- **实现特点**:
  - 基于 API 密钥的身份认证。
  - 支持 SSL/TLS 加密通信。
  - 数据验证机制防止非法访问。

---

## 4. 配置管理

### 4.1 配置属性
- **管理内容**:
  - 游戏服务器配置。
  - HTTP 客户端配置。
  - 平台集成配置。

### 4.2 监控功能
- **功能特点**:
  - 监控 HTTP 客户端活动。
  - 跟踪连接池性能。
  - 收集性能指标。

---

## 5. 最佳实践

### 5.1 代码组织
- 清晰的包结构。
- 接口与实现分离。
- 遵循单一职责原则。

### 5.2 错误处理
- 统一的异常处理机制。
- 标准化的错误码。
- 规范化的日志记录，便于调试。

### 5.3 性能优化
- 使用缓存策略。
- 优化数据库索引。
- 高效的连接池管理。

---

## 6. 依赖
- **核心框架**: Spring Boot
- **数据库**: MongoDB
- **常用工具**:
  - Lombok: 减少样板代码。
  - MapStruct: 高效的对象映射工具。
  - Apache HTTP Client: 提供高级 HTTP 通信功能。

---

## 快速开始

### 运行环境
- **Java**: JDK 8+
- **MongoDB**: 4.4+
- **Spring Boot**: 2.5+



